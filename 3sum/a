(	// functions used....	var loadSamples;	var chopSampler;	var zoner;	var peder;	var ratio;	var midiKey;	var samplePlayer;	var reverb;			// globals	var sampleBank;	sampleBank = List.new;		//----------------------------------------------------	// loadSamples function :	// receives array of sound filenames and loads details into	// global sampleBank.	loadSamples = { arg ...fArray;		fArray.do({ arg item, i; 			sampleBank.add(SoundFile.new);			if ( (sampleBank.at(i)).read(item), {},{(item ++ "not found\n").post;});		});		};	//----------------------------------------------------	// ratio function :	ratio = { arg sample1, sample2;		var signal1, signal2;		signal1 = sample1.data.at(0);		signal2 = sample2.data.at(0);			(signal1.size/ sample1.sampleRate) / (signal2.size/ sample2.sampleRate);	};	//----------------------------------------------------	// zoner function :	zoner = { arg func, boundsRect;		var x, y;		x = MouseX.kr;		y = MouseY.kr;		Pause.ar(			func, 			(x>=boundsRect.left)*(x<boundsRect.right)*(y>=boundsRect.top)*(y<boundsRect.bottom)			)	};	//----------------------------------------------------	// reverb function :	reverb = {arg in,amount;			Mix.ar([			AllpassN.ar(in, amount, [amount.rand,amount.rand], 0.2,0.245),			AllpassN.ar(in, amount, [amount.rand,amount.rand], 0.2,0.23),			AllpassN.ar(in, amount, [amount.rand,amount.rand], 0.23,0.21)		])+in;	};	//----------------------------------------------------	// peder function :	peder = { arg func, min,max;		var p;		p = MIDIController.kr(1,64,min,max,'linear',0.001);		Pause.ar(			func, 			p			)	};	//----------------------------------------------------	// chopSampler function :	chopSampler = { arg sample,pitch,chop,ratio,sus,loop,rand,loopend;			var step=0;				Spawn.ar({ arg spawn;			var signal,env,looplength,offset,table,ndx,pch,pedal,swch;						pedal = MIDIController.kr(1,64,0,2,'linear',0.0001).abs;			swch = ToggleFF.ar(a-1);						// scale pitch table			table = Signal[1,2,4];			ndx = 1;//Index.kr(table,MIDIController.kr(1,1,0,table.size,'linear'));			pch = (pitch/ratio)*(1/ndx)* MIDIController.kr(1,7,-1.0,1.0,'linear');			// calc. length of loop in time			signal = sample.data.at(0);			offset = (signal.size / chop) * rand.xrand;						a = (signal.size  / sample.sampleRate);			b = (pitch/ratio);			c = chop;						looplength = (a / b / c );						//looplength = ((signal.size  / sample.sampleRate) / chop / (pitch/ratio));									spawn.nextTime =looplength;						env = Env.linen(0.004, looplength * sus, 0.004);						loopend = (signal.size-64);						PlayBuf.ar(signal, sample.sampleRate,pch,offset, 0, loopend,EnvGen.kr(env));				},1,1);	};		//----------------------------------------------------	// sPlayer :		samplePlayer = { arg sample,n;			var	sig;		var	ptch;				ptch = (((n+24).midicps) / 400) * MIDIController.kr(1,1,-1.000,1.000,'linear')+0.01;		sig = sample.data.at(0);		l = (sig.size -32) ;		p = 0;		PlayBuf.ar(sig,sample.sampleRate,ptch,p,p,p+l);	};	//----------------------------------------------------	// midiKey function :	midiKey = { arg sample;			Voicer.ar({ arg voicer, i, synth, deltaTime, channel, note, velocity;			var ts,sig,env;			env = Env.adsr(0.0001, 1.0, 1.0, 0.5, 1, -4);			sig = samplePlayer.value(sample,note);			ts =5;//MIDIController.kr(1,11,0.1,10.0);//MouseY.kr(0.1,5.0);			EnvGen.ar(env, sig, 0, 1, 0, ts);		},1,1,8)	};			//----------------------------------------------------	// MAIN	//----------------------------------------------------//	loadSamples.value(":Sounds:160-BILL08.aif",":Sounds:160-FUJA11.aif",":Sounds:kn.3") ;	loadSamples.value(":Sounds:dk1.aif",":Sounds:Untitled 96.aif",":Sounds:bell4.aif") ;	Synth.scope({arg synth;		r = ratio.value(sampleBank.at(0),sampleBank.at(1));		p =1.1;				r=r/2;		a = chopSampler.value(sampleBank.at(0),p,1,1,1,inf,1);		b = chopSampler.value(sampleBank.at(0),p,16,1,0.9,inf,16);		c = chopSampler.value(sampleBank.at(0),p,8,1,0.5,inf,8);		d = chopSampler.value(sampleBank.at(0),p,24,1,0.3,inf,16);		e = chopSampler.value(sampleBank.at(1),p,1,r,1,inf,16);		f = chopSampler.value(sampleBank.at(1),p,16,r,0.9,inf,16);		g = chopSampler.value(sampleBank.at(1),p,16,r,0.55,inf,16);		h = chopSampler.value(sampleBank.at(1),p,12,r,0.3,inf,1);				z = Mix.ar([			peder.value( zoner.value({ a}, Rect.new(0, 0, 0.5, 0.75)),1,0) ,			peder.value( zoner.value({ c}, Rect.new(0.5, 0, 1, 0.75)),1,0) ,			peder.value( zoner.value({ e}, Rect.new(0, 0.5, 0.5, 1)),1,0) ,			peder.value( zoner.value({ g}, Rect.new(0.5, 0.5, 1, 1)),1,0) ,			peder.value( zoner.value({ b}, Rect.new(0, 0, 0.5, 0.5)),0,1) ,			peder.value( zoner.value({ d}, Rect.new(0.5, 0, 1, 0.5)),0,1) ,			peder.value( zoner.value({ f}, Rect.new(0, 0.5, 0.5, 1)),0,1) ,			peder.value( zoner.value({ h}, Rect.new(0.5, 0.5, 1, 1)),0,1) 				])*MIDIController.kr(1,12,0.0001,1.0);				y = midiKey.value(sampleBank.at(2))*MIDIController.kr(1,13,0.0001,4.0);						Mix.ar([z+reverb.value(y,0.43),reverb.value(y,0.23)+z]);				//Pan2.ar(z,-1,1) + Pan2.ar(y,1,1);	});)